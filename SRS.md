# เอกสารข้อกำหนดความต้องการซอฟต์แวร์ (SRS) — BMI Logger

## 1. บทนำ
- วัตถุประสงค์: ระบุข้อกำหนดเพื่อพัฒนาเว็บแอป BMI Logger สำหรับคำนวณและบันทึกค่าดัชนีมวลกาย (BMI) พร้อมการติดตามแนวโน้มและการส่งออกข้อมูล
- ขอบเขต: เว็บแอปที่เข้าถึงผ่านเบราว์เซอร์ รองรับการคำนวณ BMI, บันทึกประวัติ, กราฟแนวโน้ม, การส่งออก CSV และโหมดเดโม (ไม่ต้องล็อกอิน) พร้อมตัวเลือกเชื่อมต่อฐานข้อมูลในโหมดเต็ม
- นิยามศัพท์:
  - BMI = น้ำหนัก(กก.) / ส่วนสูง(เมตร)^2
  - Entry = แถวข้อมูล 1 รายการ เช่น วันที่, น้ำหนัก, ส่วนสูง, BMI, หมายเหตุ
  - โหมดเดโม = เก็บข้อมูลในเบราว์เซอร์ (localStorage)
  - โหมดเต็ม = ใช้ฐานข้อมูลภายนอก (เช่น Supabase หรือ Vercel Postgres)
- เอกสารอ้างอิง:
  - แนวปฏิบัติ SRS Checklist (ไทย)
  - มาตรฐานสุขภาพทั่วไปการตีความ BMI
- กลุ่มผู้ใช้เป้าหมาย: บุคคลทั่วไปที่ต้องการติดตาม BMI และผู้สนใจด้านสุขภาพ

## 2. ภาพรวมระบบ
- มุมมองผลิตภัณฑ์: SPA/SSR บนเว็บพร้อมหน้าเพจหลัก (คำนวณ, บันทึก, สรุป/กราฟ, ตั้งค่า)
- ฟังก์ชันหลัก:
  - คำนวณ BMI จากส่วนสูง/น้ำหนัก และจัดหมวดหมู่
  - บันทึกและแก้ไขรายการค่า BMI เป็นประวัติ
  - ดูแนวโน้มผ่านกราฟและสถิติร่วม (เฉลี่ย/ต่ำสุด/สูงสุด)
  - ส่งออกข้อมูลเป็น CSV
  - ตั้งค่า: หน่วย (กก./ปอนด์, ซม./นิ้ว), ภาษา, ธีม
- ผู้มีส่วนได้ส่วนเสีย: ผู้ใช้ปลายทาง, ผู้พัฒนา, ผู้ดูแลระบบ Platform (เช่น Vercel)
- สมมติฐาน:
  - ผู้ใช้มีอินเทอร์เน็ตและเบราว์เซอร์สมัยใหม่
  - โหมดเดโมใช้ได้ทันทีโดยไม่ต้องล็อกอิน
- ข้อจำกัด:
  - โหมดเดโมข้อมูลอยู่เฉพาะเครื่องผู้ใช้
  - โหมดเต็มต้องมีการตั้งค่าคีย์/URL ของฐานข้อมูล

## 3. ส่วนติดต่อภายนอก
- ส่วนติดต่อผู้ใช้ (UI):
  - หน้า “คำนวณ BMI”: ฟอร์มส่วนสูง/น้ำหนัก, ปุ่มคำนวณ, ผลลัพธ์และหมวดหมู่
  - หน้า “บันทึก”: ตารางรายการ, ปุ่มเพิ่ม/แก้ไข/ลบ, ฟิลด์วันที่/น้ำหนัก/ส่วนสูง/หมายเหตุ
  - หน้า “สรุป”: กราฟเส้นแนวโน้ม BMI ตามเวลา, สถิติรวม
  - หน้า “ตั้งค่า”: สลับหน่วย, ภาษา, ธีม, โหมดเดโม/เต็ม
- ส่วนติดต่อระบบภายนอก (โหมดเต็ม):
  - ฐานข้อมูล (เช่น Supabase/Vercel Postgres) ผ่าน REST/SQL API
- ส่วนติดต่อฮาร์ดแวร์: ไม่มีข้อกำหนดเฉพาะ

## 4. โมเดลข้อมูล
- ตาราง/คอลเลกชัน entries:
  - id: string/uuid
  - user_id: string (nullable ในโหมดเดโม)
  - date: yyyy-MM-dd
  - weight: number (กก.หรือปอนด์ตามหน่วย)
  - height: number (ซม.หรือนิ้วตามหน่วย)
  - bmi: number (คำนวณจากหน่วยมาตรฐาน: กก./เมตร)
  - note: string (≤ 200 ตัวอักษร)
- ตาราง users (โหมดเต็ม):
  - id: uuid, email, display_name, created_at
- กฎการคำนวณ:
  - แปลงส่วนสูงเป็นเมตรและน้ำหนักเป็นกิโลกรัมก่อนคำนวณ: bmi = kg / (m^2)
  - หมวดหมู่ทั่วไป: <18.5 ต่ำกว่าเกณฑ์, 18.5–24.9 ปกติ, 25.0–29.9 น้ำหนักเกิน, ≥30 โรคอ้วน

## 5. ความต้องการเชิงหน้าที่ (FR)
- FR-1: ผู้ใช้คำนวณ BMI จากน้ำหนัก/ส่วนสูงที่กรอกได้ทันที
- FR-2: ระบบบันทึกค่า BMI เป็นรายการประวัติ พร้อมวันที่และหมายเหตุ
- FR-3: ผู้ใช้แก้ไข/ลบรายการที่มีอยู่ได้
- FR-4: ระบบแสดงกราฟแนวโน้ม BMI ตามช่วงเวลาเลือกได้ (เช่น 30/90/365 วัน)
- FR-5: ส่งออกรายการเป็น CSV (UTF-8) ได้
- FR-6: ตั้งค่าหน่วย, ภาษา, ธีม และบันทึกค่าตั้งค่าในเครื่อง
- FR-7: โหมดเต็มรองรับการเชื่อมฐานข้อมูลและล็อกอิน (อีเมล/รหัสผ่านหรือ OAuth ภายหลัง)
- FR-8: รองรับภาษาไทยอย่างน้อย 100% ของ UI หลัก

## 6. ความต้องการเชิงคุณภาพ (NFR)
- ประสิทธิภาพ: การคำนวณ BMI และแสดงผล ≤100ms บนอุปกรณ์ทั่วไป; ตาราง/กราฟโหลด ≤1s สำหรับ ≤1,000 รายการ
- ความน่าเชื่อถือ: การบันทึกข้อมูลต้องคงทนในโหมดเดโม (localStorage) และ atomic ในโหมดเต็ม (transaction/UPSERT)
- ความปลอดภัย:
  - ไม่เก็บรหัสผ่านในฝั่งไคลเอนต์อย่างไม่เข้ารหัส
  - ใช้ HTTPS บน Public URL
  - ในโหมดเต็ม ใช้การคุมสิทธิ์ตาม user_id
- ความเป็นส่วนตัว: ข้อมูลสุขภาพเก็บเฉพาะที่จำเป็น, เปิดเผยต่อผู้อื่นเฉพาะเมื่อผู้ใช้ส่งออกเอง
- การเข้าถึง (Accessibility): คีย์บอร์ดเนวิเกชัน, คอนทราสต์สีตาม WCAG AA, aria-label สำหรับคอมโพเนนต์หลัก
- ความสามารถในการบำรุงรักษา: โครงสร้างโค้ดแบบแยกหน้าจอ/คอมโพเนนต์, แยกเลเยอร์ข้อมูล
- การพกพา: รองรับเบราว์เซอร์หลัก (Chrome, Edge, Firefox, Safari รุ่นล่าสุด)
- การแปลภาษา: รองรับไทยเริ่มต้น และมีโครงสร้างรองรับหลายภาษา

## 7. กรณีใช้งาน (Use Cases)
- UC-1: คำนวณ BMI แบบทันที
- UC-2: เพิ่มรายการ BMI พร้อมหมายเหตุ
- UC-3: แก้ไข/ลบรายการ
- UC-4: ดูกราฟแนวโน้มและสถิติรวม
- UC-5: ส่งออก CSV
- UC-6: ปรับตั้งค่าและหน่วย
- UC-7 (ตัวเลือก): ล็อกอิน/เชื่อมฐานข้อมูล

## 8. หน้าจอและโฟลว์หลัก
- หน้า Home/Calculate: ฟอร์ม + ผลลัพธ์ + ปุ่ม “บันทึก”
- หน้า Logs: ตาราง, ปุ่ม Add/Edit/Delete, ค้นหา/กรองวัน
- หน้า Summary: กราฟเส้น + ช่วงเวลา + สถิติ
- หน้า Settings: หน่วย/ภาษา/ธีม + โหมดเดโม/เต็ม

## 9. API/Storage
- โหมดเดโม (ไม่มีเซิร์ฟเวอร์):
  - Storage: localStorage keys: “bmi-entries”, “settings”
- โหมดเต็ม (ตัวอย่าง REST):
  - GET /api/entries?user_id=… — คืนรายการ
  - POST /api/entries — สร้างรายการใหม่
  - PUT /api/entries/{id} — แก้ไข
  - DELETE /api/entries/{id} — ลบ
  - Auth: POST /api/auth/login, /logout; หรือ OAuth ผ่านผู้ให้บริการ

## 10. กฎตรวจสอบข้อมูล (Validation)
- weight: >0
- height: >0
- date: รูปแบบ ISO และไม่อนาคตเกินกำหนด
- note: ความยาว ≤200 ตัวอักษร
- การแปลงหน่วย: นิ้ว→เมตร, ปอนด์→กิโลกรัมก่อนคำนวณ

## 11. การทดสอบและเกณฑ์ยอมรับ (Acceptance)
- Unit: ฟังก์ชันคำนวณ BMI, การแปลงหน่วย, การจัดหมวดหมู่
- Integration: เพิ่ม/แก้ไข/ลบรายการและกราฟแสดงผลถูกต้อง
- E2E: โฟลว์ผู้ใช้หลักจากคำนวณ→บันทึก→สรุป→ส่งออก CSV
- เกณฑ์ยอมรับ:
  - ใช้งานฟังก์ชัน FR-1…FR-6 ได้สมบูรณ์บนเบราว์เซอร์หลัก
  - NFR หลักเป็นไปตามที่กำหนด
  - UI ไทยครบถ้วนหน้าเพจหลัก

## 12. ความเสี่ยงและการบรรเทา
- ความเสี่ยง: ข้อมูลโหมดเดโมสูญหายหากผู้ใช้ล้างเบราว์เซอร์
  - บรรเทา: แจ้งเตือน, แนะนำส่งออก CSV เป็นระยะ
- ความเสี่ยง: การตั้งค่าฐานข้อมูลผิดในโหมดเต็ม
  - บรรเทา: หน้า Settings แสดงสถานะการเชื่อมต่อ/ทดสอบ

## 13. การแมปกับ SRS Checklist (ไทย)
- บทนำ/ขอบเขต/คำจำกัดความ: ครอบคลุม
- ภาพรวมผลิตภัณฑ์/ผู้ใช้/สมมติฐาน/ข้อจำกัด: ครอบคลุม
- ส่วนติดต่อภายนอก/โมเดลข้อมูล/ฟังก์ชัน: ครอบคลุม
- คุณภาพ (ประสิทธิภาพ/ปลอดภัย/ความเป็นส่วนตัว/การเข้าถึง): ครอบคลุม
- การทดสอบ/เกณฑ์ยอมรับ/ความเสี่ยง: ครอบคลุม
- หมายเหตุ: โหมดเต็ม (Auth/DB) อาจขยายรายละเอียดเพิ่มเติมในเฟส 2

## 14. ภาคผนวก
- สูตรและหมวดหมู่ BMI ตามมาตรฐาน WHO ทั่วไป
- ตัวอย่างรูปแบบ CSV: date,weight,height,bmi,note